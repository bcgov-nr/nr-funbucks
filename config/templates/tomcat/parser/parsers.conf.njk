# Used by parser filter for tomcat multiline core parsing
#
[PARSER]
    name          parser-filter-regex-tomcat-{{typeTag}}
    Format        regex
    Regex         (?m)^(?<tomcat_time>\d{2}-\w{3}-\d{4}\s\d{2}:\d{2}:\d{2}(.\d{3})?)(\s+)(?<level>\S+)(\s+)(?<message_parsed>.*)
    Time_Key      tomcat_time

# Used by parser filter for generic multiline core parsing
#
[PARSER]
    name          parser-filter-regex-generic-{{typeTag}}
    Format        regex
    Regex         (?m)^(?<tomcat_time>\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}(.\d{3})?)(\s+)(?<level>\S+)(\s+)(?<message_parsed>.*)
    Time_Key      tomcat_time

# Tomcat localhost and catalina multiline core parser
#
[MULTILINE_PARSER]
    name          multiline-core-tomcat-regex-{{typeTag}}
    type          regex
    flush_timeout 1000
    key_content message
    rule      "start_state"   "/^\d{2}-\w{3}-\d{4}\s\d{2}:\d{2}:\d{2}.\d{3}.*$/"  "cont"
    rule      "cont"          "/^[ \t+].*|Caused by.*/"    "cont"

# App (generic) multiline core parser
#
[MULTILINE_PARSER]
    name          multiline-core-app-regex-{{typeTag}}
    type          regex
    flush_timeout 1000
    key_content message
    rule      "start_state"   "/^\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}(.\d{3}?).*$/"  "cont"
    rule      "cont"          "/^[ \t+a-zA-Z{}].*/"    "cont"