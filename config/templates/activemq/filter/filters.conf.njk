# Activemq logs
#
# Parser filter for activemq core parsing
#
[FILTER]
    Name parser
    Match {{typeTag}}.audit
    Key_Name message
    Parser parser-filter-regex-audit-{{typeTag}}
    Reserve_Data On
    Preserve_Key On

# App logs (activemq)
#
[FILTER]
    Name modify
    Match {{typeTag}}.audit
    Rename tomcat_time @timestamp
    Add event.kind event
    Add event.category web
    Add event.dataset application.log
    Add @metadata.timestampFormat YYYY-MM-DD-HH:mm:ss.SSS{% if tmplTomcatTestApplicationIndex %}
    Add @metadata.index {{ tmplTomcatTestApplicationIndex }}{% endif %}
    Add labels.project {{ app | lower }}
    Add service.name {{ component | lower }}{% if environment %}
    Add service.environment {{ environment }}{% endif %}{% if organization_id %}
    Add organization.id {{ organization_id }}{% endif %}{% if organization_name %}
    Add organization.name {{ organization_name }}{% endif %}
    Add @metadata.keyAsPath true
    Rename message event.original
    Rename message_parsed message
    Rename level log.level

[FILTER]
    Name    lua
    Match   {{typeTag}}.audit
    script  {{typeTag}}/lua/activemq.lua
    call    parse_network_information

